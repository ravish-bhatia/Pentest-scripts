#!/bin/bash
# : ' ' comments

if [ $# != 1 ]; then
	echo "$#"
	echo -e "\nUSAGE: ./trick.sh <target IP address> \n"
	exit
fi
echo -e "\nDo you want to perform NMAP? (y/n)"
read var1

if [ "$var1" == "y" ] || [ "$var1" == "Y" ];then
	echo -e "\nNmap scan on top 100 ports started.... \n"
	nmap -sV -A --top-ports 100 $1 # > nmap_top100_$1
	echo -e  "Nmap Done...!! \n"
fi

echo -e "\nDo you want to perform more exhaustive nmap scan? (Y/N) "
read var2

if [ "$var2" == "y" ] || [ "$var2" == "Y" ];then
	echo -e "\nExhaustive Nmap scan started...... "
	nmap -sV -A --top-ports 1000 $1 #> exhaustive_scan_$1
	echo -e "\nNmap done on top 1000 ports..!!"
else
	echo -e "\nNo more nmap...process done"
fi


echo -e "\nPerforming NBTSCAN"
nbtscan $1

echo -e "\nPerforming SMB netbios enum on port 139 and 445"
nmap -sV -p 139,445 $1 

echo -e "\nDo you want to perform NULL SESSION/rpcclient check?(Y/N) "
echo "NOTE: check for blank username and password"
read var3
if [ "$var3" == "y" ] || [ "$var3" == "Y" ];then
	rpcclient -U "" $1
fi
echo -e  "\nNull session checked...!! "

echo -e "\nDo you want to perform ENUM4LINUX? (Y/N) "
read var4
if [ "$var4" == "y" ] || [ "$var4" == "Y" ];then
	 enum4linux -v $1
fi

echo -e "\nDo you want to perform nmap vulnerability test for SMB? (Y/N)\n "
read var5
if [ "$var5"=="y" ] || [ "$var5"="Y" ];then
	nmap -sV -p 139,445 --script-args=unsafe=1 --script=smb-vuln-* $1
fi

echo -e "\nDo you want to perform nmap vulnerability test for HTTP? (Y/N)"
read var6
if [ "$var6"=="y" ] || [ "$var6"="Y" ];then
        nmap -p 80,443 --script-args=unsafe=1 --script=http-vuln-* $1
fi

echo -e "\nDo ypu want to perform SMTP checks? (Y/N)"
read var7
if [ "$var7"=="y" ] || [ "$var7"="Y" ];then
	nmap -p 25 --script-args=unsafe=1 --script=*smtp* $1
fi

echo -e "\nPerforming SNMP enum using 'onesixtyone' tool\n"
onesixtyone -c /root/Desktop/tools/snmp_community_strings $1

echo -e "\nDo you want to perform SNMPWALK (only snmp 'VERSION 1' and 'PUBLIC' community) for particular MIB values? (Y/N) "
echo -e "NOTE: copy mib values from /root/Desktop/tools/mib-values file"
read var8

function take_mib_val() {
	echo -e "\nEnter the MIB value you want to check: "
	read var10
}

if [ "$var8"=="y" ] || [ "$var8"="Y" ];then
	var9=0
	
	while [ $var9==0 ]
	do
		take_mib_val	#here take_mib_function is called
		snmpwalk -c public -v1 $1 $take_mib_val
		echo -e "\nDo you want to check more MIB values:(Y/N) "
		read var11
		if [ "$var11"=="n" ] || [ "$var11"="N" ];then
			break
		else
			var9=0
		fi
	done	
fi
echo 'YOU ARE DONE'
#read var10
#snmpwalk -c public -v1

